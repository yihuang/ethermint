(window.webpackJsonp=window.webpackJsonp||[]).push([[71],{643:function(e,t,a){"use strict";a.r(t);var s=a(0),n=Object(s.a)({},(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h1",{attrs:{id:"gas-and-fees"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#gas-and-fees"}},[e._v("#")]),e._v(" Gas and Fees")]),e._v(" "),a("p",{attrs:{synopsis:""}},[e._v("Learn about the differences between "),a("code",[e._v("Gas")]),e._v(" and "),a("code",[e._v("Fees")]),e._v(" in Ethereum and Cosmos.")]),e._v(" "),a("h2",{attrs:{id:"pre-requisite-readings"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#pre-requisite-readings"}},[e._v("#")]),e._v(" Pre-requisite Readings")]),e._v(" "),a("ul",[a("li",{attrs:{prereq:""}},[a("a",{attrs:{href:"https://docs.cosmos.network/master/basics/gas-fees.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("Cosmos SDK Gas"),a("OutboundLink")],1)]),e._v(" "),a("li",{attrs:{prereq:""}},[a("a",{attrs:{href:"https://ethereum.org/en/developers/docs/gas/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Ethereum Gas"),a("OutboundLink")],1)])]),e._v(" "),a("p",[e._v("The concept of Gas represents the amount of computational effort required to execute specific operations on the state machine.")]),e._v(" "),a("p",[e._v("Gas was created on Ethereum to disallow the EVM (Ethereum Virtual Machine) from running infinite\nloops by allocating a small amount of monetary value into the system. A unit of gas, usually in a\nform as a fraction of the native coin, is consumed for every operation on the EVM and requires a\nuser to pay for these operations. These operations consist in state transitions such as sending a\ntransaction or calling a contract.")]),e._v(" "),a("p",[e._v("Exactly like Ethereum, Cosmos utilizes the concept of gas and this is how Cosmos tracks the resource\nusage of operations during execution. Operations on Cosmos are represented as read or writes done to the chain's store.")]),e._v(" "),a("p",[e._v("In Cosmos, a fee is calculated and charged to the user during a message execution. This fee is\ncalculated from the sum of all gas consumed in an message execution:")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"",base64:"ZmVlID0gZ2FzICogZ2FzIHByaWNlCg=="}}),e._v(" "),a("p",[e._v("In both networks, gas is used to make sure that operations do not require an excess amount of\ncomputational power to complete and as a way to deter bad-acting users from spamming the network.")]),e._v(" "),a("h2",{attrs:{id:"cosmos-sdk-gas"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#cosmos-sdk-gas"}},[e._v("#")]),e._v(" Cosmos SDK "),a("code",[e._v("Gas")])]),e._v(" "),a("p",[e._v("In the Cosmos SDK, gas is tracked in the main "),a("code",[e._v("GasMeter")]),e._v(" and the "),a("code",[e._v("BlockGasMeter")]),e._v(":")]),e._v(" "),a("ul",[a("li",[a("code",[e._v("GasMeter")]),e._v(": keeps track of the gas consumed during executions that lead to state transitions. It is reset on every transaction  execution.")]),e._v(" "),a("li",[a("code",[e._v("BlockGasMeter")]),e._v(": keeps track of the gas consumed in a block and enforces that the gas does not go over a predefined limit. This limit is defined in the Tendermint consensus parameters and can be changed via governance parameter change proposals.")])]),e._v(" "),a("p",[e._v("More information regarding gas in Cosmos SDK can be found "),a("a",{attrs:{href:"https://docs.cosmos.network/master/basics/gas-fees.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("here"),a("OutboundLink")],1),e._v(".")]),e._v(" "),a("h2",{attrs:{id:"matching-evm-gas-consumption"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#matching-evm-gas-consumption"}},[e._v("#")]),e._v(" Matching EVM Gas consumption")]),e._v(" "),a("p",[e._v("Ethermint is an EVM-compatible chain that supports Ethereum Web3 tooling. For this reason, gas\nconsumption must be equitable in order to accurately calculate the state transition hashes and exact\nthe behaviour that would be seen on the main Ethereum network (main net).")]),e._v(" "),a("p",[e._v("In Cosmos, there are types of operations that are not triggered by transactions that can also result in state transitions. Concrete examples are the  "),a("code",[e._v("BeginBlock")]),e._v(" and "),a("code",[e._v("EndBlock")]),e._v(" operations and the "),a("code",[e._v("AnteHandler")]),e._v(" checks, which might also read and write to the store before running the state transition from a transaction.")]),e._v(" "),a("h3",{attrs:{id:"beginblock-and-endblock"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#beginblock-and-endblock"}},[e._v("#")]),e._v(" "),a("code",[e._v("BeginBlock")]),e._v(" and "),a("code",[e._v("EndBlock")])]),e._v(" "),a("p",[e._v("These operations are defined by the Tendermint Core's Application Blockchain Interface (ABCI) and are defined by each Cosmos SDK module. As their name suggest, they are executed at the beginning and at the end of each block processing respectively (i.e pre and post transaction execution). Since these operations are not reflected on Ethereum, to match the the gas consumption we reset the main "),a("code",[e._v("GasMeter")]),e._v(" to 0 on Ethermint's EVM module.")]),e._v(" "),a("h3",{attrs:{id:"antehandler"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#antehandler"}},[e._v("#")]),e._v(" "),a("code",[e._v("AnteHandler")])]),e._v(" "),a("p",[e._v("The Cosmos SDK "),a("a",{attrs:{href:"https://docs.cosmos.network/master/basics/gas-fees.html#antehandler",target:"_blank",rel:"noopener noreferrer"}},[a("code",[e._v("AnteHandler")]),a("OutboundLink")],1),e._v("\nperforms basic checks prior to transaction execution. These checks are usually signature\nverification, transaction field validation, transaction fees, etc.")]),e._v(" "),a("p",[e._v("Because the gas calculated in Ethermint is done by the "),a("code",[e._v("IntrinsicGas")]),e._v(" method from go-ethereum, a\nspecial "),a("code",[e._v("AnteHandler")]),e._v(" that is customized for EVM transaction fee verification is required. This\nallows Ethermint to generate the expected gas costs for operations done in the network and scale the\ngas costs as it would in the Ethereum network.")]),e._v(" "),a("h2",{attrs:{id:"gas-refunds"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#gas-refunds"}},[e._v("#")]),e._v(" Gas Refunds")]),e._v(" "),a("p",[e._v("In Ethereum, gas can be specified prior to execution and the remaining gas will be refunded back to\nthe user if any gas is left over - should fail with out of gas if not enough gas was provided. In\nEthermint, the concept of gas refunds does not exist and the fees paid is not refunded in part back\nto the user. The fees exacted on a transaction will be collected by the validator and no refunds are\nissued. Thus, it is extremely important to use the correct gas.")]),e._v(" "),a("p",[e._v("To prevent overspending on fees, providing the "),a("code",[e._v("--gas-adjustment")]),e._v(" flag for a cosmos transactions\nwill determine the fees automatically. Also the "),a("code",[e._v("eth_estimateGas")]),e._v(" rpc call can be used to manually\nget the correct gas costs for a transaction.")]),e._v(" "),a("h2",{attrs:{id:"_0-fee-transactions"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_0-fee-transactions"}},[e._v("#")]),e._v(" 0 Fee Transactions")]),e._v(" "),a("p",[e._v("In Cosmos, a minimum gas price is not enforced by the "),a("code",[e._v("AnteHandler")]),e._v(" as the "),a("code",[e._v("min-gas-prices")]),e._v(" is\nchecked against the local node/validator. In other words, the minimum fees accepted are determined\nby the validators of the network, and each validator can specify a different value for their fees.\nThis potentially allows end users to submit 0 fee transactions if there is at least one single\nvalidator that is willing to include transactions with "),a("code",[e._v("0")]),e._v(" gas price in their blocks proposed.")]),e._v(" "),a("p",[e._v("For this same reason, in Ethermint it is possible to send transactions with "),a("code",[e._v("0")]),e._v(" fees for transaction\ntypes other than the ones defined by the "),a("code",[e._v("evm")]),e._v(" module. EVM module transactions cannot have "),a("code",[e._v("0")]),e._v(" fees\nas gas is required inherently by Ethereum. This check is done by the evm transactions\n"),a("code",[e._v("ValidateBasic")]),e._v(" function as well as on the custom "),a("code",[e._v("AnteHandler")]),e._v(" defined by Ethermint.")]),e._v(" "),a("h2",{attrs:{hide:"",id:"next"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#next"}},[e._v("#")]),e._v(" Next")]),e._v(" "),a("p",{attrs:{hide:""}},[e._v("Learn about the "),a("RouterLink",{attrs:{to:"/basics/photon.html"}},[e._v("Photon")]),e._v(" token")],1)],1)}),[],!1,null,null,null);t.default=n.exports}}]);