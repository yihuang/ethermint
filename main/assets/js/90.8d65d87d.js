(window.webpackJsonp=window.webpackJsonp||[]).push([[90],{597:function(t,e,a){"use strict";a.r(e);var l=a(0),v=Object(l.a)({},(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"state"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#state"}},[t._v("#")]),t._v(" State")]),t._v(" "),a("p",[t._v("The "),a("code",[t._v("x/evm")]),t._v(" module keeps the following objects in state:")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th"),t._v(" "),a("th",[t._v("Key")]),t._v(" "),a("th",[t._v("Value")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("Block Height")]),t._v(" "),a("td",[a("code",[t._v("[]byte{1} + []byte(block.Hash)")])]),t._v(" "),a("td",[a("code",[t._v("BigEndian(block.Height)")])])]),t._v(" "),a("tr",[a("td",[t._v("Bloom")]),t._v(" "),a("td",[a("code",[t._v("[]byte{2} + []byte(block.Height)")])]),t._v(" "),a("td",[a("code",[t._v("[]byte(Bloom)")])])]),t._v(" "),a("tr",[a("td",[t._v("Tx Logs")]),t._v(" "),a("td",[a("code",[t._v("[]byte{3} + []byte(tx.Hash)")])]),t._v(" "),a("td",[a("code",[t._v("amino([]Log)")])])]),t._v(" "),a("tr",[a("td",[t._v("Account Code")]),t._v(" "),a("td",[a("code",[t._v("[]byte{4} + []byte(code.Hash)")])]),t._v(" "),a("td",[a("code",[t._v("[]byte(Code)")])])]),t._v(" "),a("tr",[a("td",[t._v("Account Storage")]),t._v(" "),a("td",[a("code",[t._v("[]byte{5} + []byte(address) + []byte(state.Key)")])]),t._v(" "),a("td",[a("code",[t._v("[]byte(state.Value)")])])]),t._v(" "),a("tr",[a("td",[t._v("Chain Config")]),t._v(" "),a("td",[a("code",[t._v("[]byte{6}")])]),t._v(" "),a("td",[a("code",[t._v("amino(ChainConfig)")])])])])]),t._v(" "),a("h2",{attrs:{id:"commitstatedb"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#commitstatedb"}},[t._v("#")]),t._v(" "),a("code",[t._v("CommitStateDB")])]),t._v(" "),a("p",[a("code",[t._v("StateDB")]),t._v("s within the ethereum protocol are used to store anything within the IAVL tree. "),a("code",[t._v("StateDB")]),t._v("s\ntake care of caching and storing nested states. It's the general query interface to retrieve\ncontracts and accounts")]),t._v(" "),a("p",[t._v("The Ethermint "),a("code",[t._v("CommitStateDB")]),t._v(" is a concrete type that implements the EVM "),a("code",[t._v("StateDB")]),t._v(" interface.\nInstead of using a trie and database for querying and persistence, the "),a("code",[t._v("CommitStateDB")]),t._v(" uses\n"),a("code",[t._v("KVStores")]),t._v(" (key-value stores) and Cosmos SDK "),a("code",[t._v("Keeper")]),t._v("s to facilitate state transitions.")]),t._v(" "),a("p",[t._v("The "),a("code",[t._v("CommitStateDB")]),t._v(" contains a store key that allows the DB to write to a concrete subtree of the\nmultistore that is only accessible to the EVM module.")]),t._v(" "),a("p",[a("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"Ly8gQ29tbWl0U3RhdGVEQiBpbXBsZW1lbnRzIHRoZSBHZXRoIHN0YXRlLlN0YXRlREIgaW50ZXJmYWNlLiBJbnN0ZWFkIG9mIHVzaW5nCi8vIGEgdHJpZSBhbmQgZGF0YWJhc2UgZm9yIHF1ZXJ5aW5nIGFuZCBwZXJzaXN0ZW5jZSwgdGhlIEtlZXBlciB1c2VzIEtWU3RvcmVzCi8vIGFuZCBhbiBhY2NvdW50IG1hcHBlciBpcyB1c2VkIHRvIGZhY2lsaXRhdGUgc3RhdGUgdHJhbnNpdGlvbnMuCi8vCi8vIFRPRE86IFRoaXMgaW1wbGVtZW50YXRpb24gaXMgc3ViamVjdCB0byBjaGFuZ2UgaW4gcmVnYXJkcyB0byBpdHMgc3RhdGVmdWxsCi8vIG1hbm5lci4gSW4gb3RoZXJ3b3JkcywgaG93IHRoaXMgcmVsYXRlcyB0byB0aGUga2VlcGVyIGluIHRoaXMgbW9kdWxlLgp0eXBlIENvbW1pdFN0YXRlREIgc3RydWN0IHsKCS8vIFRPRE86IFdlIG5lZWQgdG8gc3RvcmUgdGhlIGNvbnRleHQgYXMgcGFydCBvZiB0aGUgc3RydWN0dXJlIGl0c2VsZiBvcHBvc2VkCgkvLyB0byBiZWluZyBwYXNzZWQgYXMgYSBwYXJhbWV0ZXIgKGFzIGl0IHNob3VsZCBiZSkgaW4gb3JkZXIgdG8gaW1wbGVtZW50IHRoZQoJLy8gU3RhdGVEQiBpbnRlcmZhY2UuIFBlcmhhcHMgdGhlcmUgaXMgYSBiZXR0ZXIgd2F5LgoJY3R4IHNkay5Db250ZXh0CgoJc3RvcmVLZXkgICAgICBzZGsuU3RvcmVLZXkKCXBhcmFtU3BhY2UgICAgcGFyYW1zLlN1YnNwYWNlCglhY2NvdW50S2VlcGVyIEFjY291bnRLZWVwZXIKCgkvLyBhcnJheSB0aGF0IGhvbGQgJ2xpdmUnIG9iamVjdHMsIHdoaWNoIHdpbGwgZ2V0IG1vZGlmaWVkIHdoaWxlIHByb2Nlc3NpbmcgYQoJLy8gc3RhdGUgdHJhbnNpdGlvbgoJc3RhdGVPYmplY3RzICAgICAgICAgW11zdGF0ZUVudHJ5CglhZGRyZXNzVG9PYmplY3RJbmRleCBtYXBbZXRoY21uLkFkZHJlc3NdaW50IC8vIG1hcCBmcm9tIGFkZHJlc3MgdG8gdGhlIGluZGV4IG9mIHRoZSBzdGF0ZSBvYmplY3RzIHNsaWNlCglzdGF0ZU9iamVjdHNEaXJ0eSAgICBtYXBbZXRoY21uLkFkZHJlc3Ndc3RydWN0e30KCgkvLyBUaGUgcmVmdW5kIGNvdW50ZXIsIGFsc28gdXNlZCBieSBzdGF0ZSB0cmFuc2l0aW9uaW5nLgoJcmVmdW5kIHVpbnQ2NAoKCXRoYXNoLCBiaGFzaCBldGhjbW4uSGFzaAoJdHhJbmRleCAgICAgIGludAoJbG9nU2l6ZSAgICAgIHVpbnQKCgkvLyBUT0RPOiBEZXRlcm1pbmUgaWYgd2UgYWN0dWFsbHkgbmVlZCB0aGlzIGFzIHdlIGRvIG5vdCBuZWVkIHByZWltYWdlcyBpbgoJLy8gdGhlIFNESywgYnV0IGl0IHNlZW1zIHRvIGJlIHVzZWQgZWxzZXdoZXJlIGluIEdldGguCglwcmVpbWFnZXMgICAgICAgICAgIFtdcHJlaW1hZ2VFbnRyeQoJaGFzaFRvUHJlaW1hZ2VJbmRleCBtYXBbZXRoY21uLkhhc2hdaW50IC8vIG1hcCBmcm9tIGhhc2ggdG8gdGhlIGluZGV4IG9mIHRoZSBwcmVpbWFnZXMgc2xpY2UKCgkvLyBEQiBlcnJvci4KCS8vIFN0YXRlIG9iamVjdHMgYXJlIHVzZWQgYnkgdGhlIGNvbnNlbnN1cyBjb3JlIGFuZCBWTSB3aGljaCBhcmUKCS8vIHVuYWJsZSB0byBkZWFsIHdpdGggZGF0YWJhc2UtbGV2ZWwgZXJyb3JzLiBBbnkgZXJyb3IgdGhhdCBvY2N1cnMKCS8vIGR1cmluZyBhIGRhdGFiYXNlIHJlYWQgaXMgbWVtby1pemVkIGhlcmUgYW5kIHdpbGwgZXZlbnR1YWxseSBiZSByZXR1cm5lZAoJLy8gYnkgU3RhdGVEQi5Db21taXQuCglkYkVyciBlcnJvcgoKCS8vIEpvdXJuYWwgb2Ygc3RhdGUgbW9kaWZpY2F0aW9ucy4gVGhpcyBpcyB0aGUgYmFja2JvbmUgb2YKCS8vIFNuYXBzaG90IGFuZCBSZXZlcnRUb1NuYXBzaG90LgoJam91cm5hbCAgICAgICAgKmpvdXJuYWwKCXZhbGlkUmV2aXNpb25zIFtdcmV2aXNpb24KCW5leHRSZXZpc2lvbklEIGludAoKCS8vIFBlci10cmFuc2FjdGlvbiBhY2Nlc3MgbGlzdAoJYWNjZXNzTGlzdCAqYWNjZXNzTGlzdAoKCS8vIG11dGV4IGZvciBzdGF0ZSBkZWVwIGNvcHlpbmcKCWxvY2sgc3luYy5NdXRleAp9"}})],1),t._v(" "),a("p",[t._v("The functionalities provided by the Ethermint "),a("code",[t._v("StateDB")]),t._v(" are:")]),t._v(" "),a("ul",[a("li",[t._v("CRUD of "),a("code",[t._v("stateObject")]),t._v("s and accounts:\n"),a("ul",[a("li",[t._v("Balance")]),t._v(" "),a("li",[t._v("Code")]),t._v(" "),a("li",[t._v("Nonce")]),t._v(" "),a("li",[t._v("State")])])]),t._v(" "),a("li",[t._v("EVM module parameter getter and setter")]),t._v(" "),a("li",[t._v("State transition logic\n"),a("ul",[a("li",[t._v("Preparation: transaction index and hash, block hash")])])]),t._v(" "),a("li",[t._v("CRUD of transaction logs")]),t._v(" "),a("li",[t._v("Aggregate queries")]),t._v(" "),a("li",[t._v("Snapshot state\n"),a("ul",[a("li",[t._v("Identify current state with a revision")]),t._v(" "),a("li",[t._v("Revert state to a given revision")])])]),t._v(" "),a("li",[t._v("State transition and persistence\n"),a("ul",[a("li",[t._v("Preparation: tx and block context")]),t._v(" "),a("li",[t._v("Commit state objects")]),t._v(" "),a("li",[t._v("Finalise state objects")]),t._v(" "),a("li",[t._v("Export state for upgrades")])])]),t._v(" "),a("li",[t._v("Auxiliary functions\n"),a("ul",[a("li",[t._v("Copy state")]),t._v(" "),a("li",[t._v("Reset state")])])])])])}),[],!1,null,null,null);e.default=v.exports}}]);